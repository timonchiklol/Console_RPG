{% extends "base.html" %}

{% block title %}Landing - D&D Console Adventure{% endblock %}

{% block content %}
<div id="app" v-cloak class="container mx-auto p-4">
  <h1 class="medieval text-3xl mb-4">Welcome to D&D Console Adventure</h1>
  <div class="mb-4">
    <input v-model="playerName" placeholder="Enter your name" class="px-4 py-2 rounded-lg bg-gray-700 text-white w-full">
        </div>
            <div class="mb-4">
    <button @click="createRoom" :disabled="!playerName.trim()" 
            :class="['bg-green-700', !playerName.trim() ? 'opacity-50 cursor-not-allowed' : 'hover:bg-green-600', 'px-4', 'py-2', 'rounded-lg', 'medieval', 'w-full']">
      Create Room
                </button>
            </div>
  <div class="mb-4">
    <input v-model="joinRoomId" placeholder="Enter Room Code" class="px-4 py-2 rounded-lg bg-gray-700 text-white w-full mb-2">
    <button @click="joinRoom" :disabled="!playerName.trim() || !joinRoomId.trim()" 
            :class="['bg-blue-700', (!playerName.trim() || !joinRoomId.trim()) ? 'opacity-50 cursor-not-allowed' : 'hover:bg-blue-600', 'px-4', 'py-2', 'rounded-lg', 'medieval', 'w-full']">
      Join Room
                    </button>
                </div>

  <!-- Кнопка Feedback (меняем цвет на темно-красный) -->
  <div class="mb-4">
    <button @click="feedbackVisible = true" 
            class="bg-red-900 hover:bg-red-800 px-4 py-2 rounded-lg medieval w-full">
      Feedback
    </button>
  </div>

  <!-- Модальное окно для feedback -->
  <div v-if="feedbackVisible" class="modal fixed inset-0 flex items-center justify-center bg-black bg-opacity-50">
    <div class="bg-blue-900 p-6 rounded-lg shadow-lg text-white">
      <h2 class="text-xl font-bold mb-2">Feedback</h2>
      <p class="mb-4">Our email: flappyfeedback@gmail.com</p>
      <button @click="feedbackVisible = false" class="bg-red-700 hover:bg-red-600 px-4 py-2 rounded-lg text-white">
        Close
      </button>
    </div>
  </div>
</div>
    <script>
const { createApp } = Vue;

        createApp({
            data() {
                return {
                    playerName: '',
                    joinRoomId: '',
      roomJoined: false,
      roomId: '',
      // Переменная для контроля видимости модального окна feedback
      feedbackVisible: false
    };
            },
            methods: {
                async createRoom() {
      if (!this.playerName.trim()) return;
      try {
                    const response = await fetch('/create_room', {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify({ player_name: this.playerName })
        });
        const data = await response.json();
                    if (data.status === 'success') {
          this.roomId = data.room_id;
          this.roomJoined = true;
          window.location.href = '/character';
        } else {
          alert('Error creating room');
        }
      } catch (e) {
        console.error(e);
                    }
                },
                async joinRoom() {
      if (!this.playerName.trim() || !this.joinRoomId.trim()) return;
                    try {
                        const response = await fetch('/join_room', {
                            method: 'POST',
                            headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({ player_name: this.playerName, room_id: this.joinRoomId })
        });
        const data = await response.json();
                        if (data.status === 'success') {
          this.roomId = data.room_id;
          this.roomJoined = true;
          window.location.href = '/character';
                        } else {
          alert(data.message || 'Error joining room.');
        }
      } catch (e) {
        console.error(e);
      }
    }
  }
}).mount('#app');
    </script>
{% endblock %} 